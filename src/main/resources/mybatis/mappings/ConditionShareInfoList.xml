<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.liuhu.socket.dao.ConditionShareInfoMapper">
    <resultMap id="BaseResultMap" type="com.liuhu.socket.entity.ConditionShareCodeInfo">
        <result column="id" property="id" jdbcType="INTEGER"/>
        <result column="date" property="date" jdbcType="DATE"/>
        <result column="type" property="type" jdbcType="VARCHAR"/>
        <result column="share_code" property="shareCode" jdbcType="VARCHAR"/>
        <result column="count_day" property="countDay" jdbcType="INTEGER"/>
        <result column="sum_ratio" property="sumRatio" jdbcType="DECIMAL"/>

    </resultMap>



    <insert id="insertList" parameterType="java.util.List">
        replace into condition_share_info(share_code,type,date,sum_ratio,count_day) VALUES
        <foreach collection="list" item="item" separator=",">
         (#{item.shareCode},#{item.type},#{item.date},#{item.sumRatio},#{item.countDay})
        </foreach>
    </insert>

    <select id="queryShareCodeByCondition" resultMap="BaseResultMap">
         select * from condition_share_info where 1=1
         <if test="condition.startTime!=null">
             and date >=#{condition.startTime}
         </if>
        <if test="condition.endTime!=null">
            and date &lt;=#{condition.endTime}
        </if>
        <if test="condition.planList!=null">
            and type in
            <foreach collection="condition.planList" item="item" separator="," open="(" close=")" >
               #{item}
            </foreach>
        </if>
        order by type
    </select>
    <select id="queryMaxStartTime" resultType="java.lang.String">
        select max(date) from condition_share_info
    </select>


</mapper>